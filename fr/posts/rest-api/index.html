<!doctype html><html><head><title>Introduction aux API REST</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/navigators/navbar.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/favicon_hu8376fd15465fef26ffe66b6bcf0ca686_13669_42x0_resize_box_2.png><link rel=stylesheet href=/css/style.css><meta name=description content="Introduction aux API REST(avec un tutoriel)"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/fr><img src=/images/main-logo_hu864bbe108f1be1ae04b57f7f2fd9d631_5637_42x0_resize_box_2.png>Salayna's Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div><img src=/images/main-logo_hu864bbe108f1be1ae04b57f7f2fd9d631_5637_42x0_resize_box_2.png class=d-none id=main-logo>
<img src=/images/inverted-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_42x0_resize_box_2.png class=d-none id=inverted-logo></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><input type=text placeholder=Search data-search id=search-box><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/fr/posts data-filter=all>Des postes</a></li><div class=subtree><li><a href=/fr/posts/introduction/>Introduction</a></li><li><a class=active href=/fr/posts/rest-api/>Introduction aux API REST</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://salayna.github.io/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/Salayna.png><h5 class=author-name>Salayna Doukoure</h5><p>March 1, 2021</p></div><div class=title><h1>Introduction aux API REST</h1></div><div class=post-content id=post-content><h1 id=quest-ce-quune-api>Qu&rsquo;est ce qu&rsquo;une API</h1><p>Une API (Application Programming Interface) est un set de méthodes, de variables, et de protocoles permettent d&rsquo;interfacer deux applications. On distingue plusieurs types d&rsquo;API:</p><ul><li>d&rsquo;un côté on peut avoir une API qui servir à utilisé les fonctions d&rsquo;une autre application, pour par exemple intégrer certains modules à d&rsquo;autres</li><li>de l&rsquo;autre côté on peut avoir une api qui servir des données à notre application comme les API en GraphQL ou Rest(ce qiue l&rsquo;on va voir aujourd&rsquo;hui)</li></ul><h2 id=le-modèle-rest>Le modèle REST</h2><p>Le modèle <strong>REST</strong>(REpresentational State Transfer) est un ensemble de règles et de contraintes à respecter pour la création de services web. Ces services permettent manipulation de resources web et se repose lourdement sur le protocoles HTTP.</p><h3 id=le-protocole-http-en-bref>Le protocole HTTP en bref</h3><p>Le protocole HTTP est l&rsquo;un des protocoles principale du World Wide Web(les fameux www). Le HTTP se repose lui même sur le MIME(Multipurpose Internet Mail Extensions) qui définis les fichiers transferable à travers internet(comme son nom l&rsquo;indique le MIME a été d&rsquo;abord pensé pour l&rsquo;envoie de différents types de fichiers par mail)</p><h4 id=les-méthodes>Les méthodes</h4><p>Le protocole compte des méthodes qui vont définir les actions possible sur les ressources, parmis lesquels on peut compter:</p><ul><li>GET est la méthode qui permet de demander une ressource au serveur</li><li>POST permet d&rsquo;envoyer des données au serveur</li><li>PUT permet aussi d&rsquo;envoyé des données au serveur en vue d&rsquo;un ajout ou d&rsquo;une modification totale de la ressource</li><li>DELETE permet de supprimer la ressource visé</li><li>PATCH permet d&rsquo;effectuer une modification partiel de la ressource</li></ul><p>Les API REST vont se reposé sur les méthodes http pour gérer leurs requêtes.</p><h1 id=implémentons>Implémentons</h1><p><em>ps: On utilisera du NodeJS pour ce tutoriel, le but de comprendre comment ça marche, vous pourrez trouver un repos github contenant le code du tutoriel à la fin de celui ci</em></p><h2 id=initialisation-du-projet>Initialisation du projet</h2><p>Pour commencer nous allons initialisé notre projet comme ceci:</p><ul><li>on va d&rsquo;abord créer notre dossier (le nom importe peu)</li><li>on s&rsquo;assure que Node est installé avec la commande <code>node -v</code> si ce n&rsquo;est pas le cas je vous renvoie vers le site officiel <a href=https://nodejs.org/en/download/>https://nodejs.org/en/download/</a></li><li>Une fois Node installé on va effectuer la commande <code>npm init</code>,on devrait avoir un prompt où remplir des informations trivial à la suite de quoi on aura à la racine de notre projet un fichier <code>package.json</code>.</li><li>on va ensuite créer un fichier index.js ausi la racine du projet.</li></ul><p>Avant d&rsquo;aller plus loin on va d&rsquo;abord expliquer quelques points vu au dessus:</p><h3 id=quest-ce-que-nodejs->Qu&rsquo;est-ce que NodeJS ?</h3><p>NodeJS est une plateforme logiciel qui permet de booster le Javascript qui, avant tout ça était surtout un langages utilisé pour faire de belles animation et rendre un peu plus dynamique les sites webs. Le NodeJS permet au Javascript d&rsquo;être utilisé côté serveur et de faire un bon nombre de choses assez incroyable (programmation asynchrone etc&mldr;)</p><h3 id=à-quoi-sert-le-fichier-packagejson>À quoi sert le fichier package.json</h3><p>le fichier package.json sert de fichier de controle pour votre projet. Le nom, l&rsquo;auteur, des script utile, les dépendances et pleins d&rsquo;autres informations sont stocké à l&rsquo;interieur de ce fichier.</p><h3 id=ajout-de-dépendances>Ajout de dépendances</h3><p>On va avoir besoin de quelques dépendances pour ce projet.</p><ul><li>Express: pour la création du serveur web et la gestion de requêtes</li><li>Body-Parser: Pour la récupération du corps des requêtes</li><li>nodemon: pour ne pas avoir à toujours redémarrer notre app pendant que l&rsquo;on développe</li></ul><p>Pour installer ces dépendances on va utilisé la commande <code>npm install express body-parser</code><br>Vous noterez que je n&rsquo;ai pas mis nodemon dans la commande juste, c&rsquo;est parce que je veux avoir nodemon que pendant le développement et pas en production, donc je vais l&rsquo;installer en <strong>dev dependency</strong> comme ceci:<br><code>npm install --save-dev nodemon</code><br>Votre ficher <code>package.json</code> devrait maintenant avoir ces dex objets:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#e6db74>&#34;dependencies&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
   <span style=color:#f92672>&#34;body-parser&#34;</span>: <span style=color:#e6db74>&#34;^1.19.0&#34;</span>,
   <span style=color:#f92672>&#34;express&#34;</span>: <span style=color:#e6db74>&#34;^4.17.1&#34;</span>
 }<span style=color:#960050;background-color:#1e0010>,</span>
 <span style=color:#e6db74>&#34;devDependencies&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
   <span style=color:#f92672>&#34;nodemon&#34;</span>: <span style=color:#e6db74>&#34;^2.0.7&#34;</span>
 }
</code></pre></div><p>et votre dossier compte iun maintenat un fichier <code>package-lock.json</code> qui répertory les dépendances de vos dépendances, qui sont contenue dans le dossier nodes_modules(Je vous déconseille fortement de toucher à ces deux entités, mais vous pouvez regarder si vous êtes de nature curieuse).</p><p>maintenant que notre projet est en place, on peut commencer à coder.</p><h2 id=création-de-notre-serveur-web-et-envoie-de-texte>Création de notre serveur web et envoie de texte</h2><p>Dans le ficher index.js on va ajouter le code suivant:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>express</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;express&#34;</span>);
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>app</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>express</span>();

<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>sendStartingMessage</span>(<span style=color:#a6e22e>port</span>) {
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;app running on port &#39;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>port</span>)
}
<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>listen</span>(<span style=color:#ae81ff>3000</span>, <span style=color:#a6e22e>startingMessage</span>(<span style=color:#ae81ff>3000</span>));
</code></pre></div><p>Maintenant en effectuant la commande <code>node .</code> à la racine de notre projet on devrait avoir le message &ldquo;app running on port 3000&rdquo;. Ok,mais comment ça se fait ? Reprenon le code ligne par ligne.<br>Dans les deux première ligne on va importer notre module avec la fonction require("<code>{le nom du module à importer}</code>"), dont on va créer un objet dans la variable app. On va ensuite créer un port d&rsquo;écoute avec la fonction <code>listen()</code> qui prends en paramètre le port d&rsquo;écoute. Vous noterez que <code>listen()</code> a aussi un paramètre assez particulier qui est la fonction <code>sendStartingMessage()</code>, c&rsquo;est ce qu&rsquo;on appelle un callback et ce callback ne va être effectuer que si le serveur est est bien initialisé.effectuons un tout petit changement à ce dernier.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>express</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;express&#34;</span>);
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>app</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>express</span>();

<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>listen</span>(<span style=color:#ae81ff>3000</span>, ()=&gt;{
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;app running on port 3000&#39;</span>);
});
</code></pre></div><p>Votre server fonctionne maintenant mais vous ne pouvez rien faire, on va donc créer notre premier endpoint juste au dessus de notre <code>app.listen()</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt; {
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#34;Welcome to your first API endpoint&#34;</span>)
});
</code></pre></div><p>Nous venons tout juste de rajouter un GET avec la fonction <code>app.get()</code> qui prends en paramètre la route de la ressource dans ce cas ci la racine &lsquo;/&rsquo; et une callback dont les arguments seront req: la requête, res: la réponse on va ensuite dire, dans ce callback, à notre serveur d&rsquo;envoyé comme réponse &ldquo;Welcome to your first API endpoint&rdquo;;
Avant de tester cette requête on va juste rajouter un petit script qui va nous simplifier la vie dans le <code>package.json</code>. dans l&rsquo;objet scripts ajoutez:
<code>"dev:start": "nodemon ."</code><br>votre object scripts devrait maintenant ressembler à ça:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#e6db74>&#34;scripts&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
    <span style=color:#f92672>&#34;test&#34;</span>: <span style=color:#e6db74>&#34;echo \&#34;Error: no test specified\&#34; &amp;&amp; exit 1&#34;</span>,
    <span style=color:#f92672>&#34;dev:start&#34;</span>: <span style=color:#e6db74>&#34;nodemon .&#34;</span>
  }<span style=color:#960050;background-color:#1e0010>,</span>
</code></pre></div><p>vous pouvez ensuite interrompre l&rsquo;exécution de votre code et taper la commande <code>npm run dev:start</code> dans le terminal. maintenant à chaque que vous sauvergarderez vos modifications le code sera exécuté automatiquement.
Pour tester si notre GET fonctionne, rien de plus simple, on va juste aller sur notre navigateur et allez à l&rsquo;adresse suivante: http://localhost:3000/
vous devriez avoir ce résultat.<br><img src=images/api-message.png alt=response>.</p><p>Avant d&rsquo;aller plus loin créer des données factices pour notre API. Créons donc un tableau cars qui sera un tableau de voiture</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cars</span> <span style=color:#f92672>=</span> [];

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>car1</span> <span style=color:#f92672>=</span> {
    <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Tesla Model S&#34;</span>,
    <span style=color:#a6e22e>proprio</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Mr Iervese&#34;</span>,
    <span style=color:#a6e22e>date</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2017</span>,
}

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>car2</span> <span style=color:#f92672>=</span> {
    <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>,
    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Lamborghini Urus&#34;</span>,
    <span style=color:#a6e22e>proprio</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Mr Hagot&#34;</span>,
    <span style=color:#a6e22e>date</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2019</span>,
}

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>car3</span> <span style=color:#f92672>=</span> {
    <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span>,
    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Ferrari Roma&#34;</span>,
    <span style=color:#a6e22e>proprio</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Mr Georges&#34;</span>,
    <span style=color:#a6e22e>date</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2016</span>,
}

<span style=color:#a6e22e>cars</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>car1</span>, <span style=color:#a6e22e>car2</span>, <span style=color:#a6e22e>car3</span>);
</code></pre></div><h2 id=api-crud>API CRUD</h2><p>Dans la partie ci-dessous on va implémenter un CRUD (Create Read Update Delete) sur les voitures.</p><h3 id=read>Read</h3><p>Le Read passe donc par la méthode GET du protocole HTTP.On va d&rsquo;avord conc commencer par le Read étant la fonction la plus simple, on fera trois lecture une qui permettra de récupérer toutes les voitures et deux qui permettront de récupérer une voiture en fonction de ses attributs.
Pour le premier Read on va rajouter un endpoint sur la route &lsquo;/cars&rsquo;. et ce endpoint renverra juste le contenue de notre tableau cars.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;api/cars&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt; {
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>cars</span>);
})
</code></pre></div><p>Assez simple comme première fonction <em>notez que je fais ici abstraction de tout ce qui est base de données dans un exemple d&rsquo;API en production(surement la prochaine leçon) le code sera beaucoup plus fourni</em>. Pour la prochaine fonction on récupèrera une voiture en fonction de paramètres de la voiture en paramètre en utilisant le paramètre req de la callback de la fonction get. Mais il y a deux manière de récupérer le paramètre soit à travers le <code>req.query</code> ou à travers le <code>req.params</code> le choix de l&rsquo;un des deux va drastiquement changer comment coder sa fonction. On va donc voir les deux.</p><h4 id=reqparams>req.params</h4><p><strong>req.params</strong> va s&rsquo;occuper de parser les paramètre au niveau de la route et pas de l&rsquo;URL. La différence entre la route et l&rsquo;url est assez subtile mais disons que l&rsquo;URL est l&rsquo;entité en entière par exemple le &ldquo;https://localhost:3000/cars&rdquo; là où la route est plus une définission de chemin par exemple <code>api/cars/</code>. Pour utilisé req.params on va d&rsquo;abord dire au router de notre api qu&rsquo;on attent une valeur au niveau de la route comme ceci:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/api/cars/:id&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt;{
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>id</span>  <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>id</span>
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>car</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cars</span>.<span style=color:#a6e22e>find</span>(<span style=color:#a6e22e>element</span> =&gt; <span style=color:#a6e22e>element</span>.<span style=color:#a6e22e>id</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>id</span>);
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>car</span>);
});
</code></pre></div><p>Comme vous pouvez la route a une forme particulière avec son <code>:id</code>, ce <code>:id</code> va permettre de dire à l&rsquo;api qu&rsquo;ici on attent une variable et c&rsquo;est cette variable qu&rsquo;on va récupérer avec le <code>req.params.id</code>.
l&rsquo;URl aura donc cette tête: <code>http://localhost:3000/api/cars/2</code></p><h4 id=reqquery>req.query</h4><p>Pour le <strong>req.query</strong> la requête va totalement changer de tête puisque les paramètre vont être parser après un <code>?</code> et on a pas besoin de spécifier au router de l&rsquo;api avant. la route aura donc cette tête:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/api/car&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt;{
 <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>query</span>.<span style=color:#a6e22e>id</span>;
 <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>date</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>query</span>.<span style=color:#a6e22e>date</span>;
 <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>car</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cars</span>.<span style=color:#a6e22e>find</span>(<span style=color:#a6e22e>element</span> =&gt; (<span style=color:#a6e22e>element</span>.<span style=color:#a6e22e>id</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>id</span>) <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#a6e22e>element</span>.<span style=color:#a6e22e>date</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>date</span>));
 <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>car</span>); 
});
</code></pre></div><p>cotez que vous pouvez mettre autant paramètre que vous voulez et que donc vous devez réfléchir en amont à ce que vous voulez récupérer sachant que si les paramètres ne sont pas pris en compte dans le code c&rsquo;est comme s&rsquo;ils n&rsquo;existent pas.
l&rsquo;url pour cettre route ressemblera à ça: <code>http://localhost:3000/api/car?id=2&date=2019</code>.</p><p>Nous avons donc mis en place nos routes <code>GET</code> mais celà ne s&rsquo;arrête pas là ils nous reste <code>POST</code>(pour le CREATE), <code>PATCH</code>(pour le UPDATE), <code>DELETE</code>(pour le DELETE). Passons donc au POST.</p><h3 id=create>CREATE</h3><p>pour cette fonction on passer par la méthode POST du protocole HTTP, mais ce sera un peu spécial cette fois ci et un peu plus fourni. Dans le cas de la méthode POSt on va passer les données dans le corps de la requête la body et pour se faire on devoir le parser, c&rsquo;est là qu&rsquo;intervient <code>body-parser</code> qui va passer en tant que middleware à express comme montrer ci dessous</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bodyParser</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;body-parser&#34;</span>);
<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>use</span>(<span style=color:#a6e22e>bodyParser</span>.<span style=color:#a6e22e>json</span>())
</code></pre></div><p>body-parser va donc s&rsquo;occuper de parser les données que l&rsquo;API va recevoir. Maintenant il faut que l&rsquo;on cré la route qui va s&rsquo;occuper de recevoir ces données donc on va créer une route post cette fois ci:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/api/cars&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt; {
 <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>body</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>body</span>;
 <span style=color:#a6e22e>cars</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>body</span>);
 <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>body</span>);
});
</code></pre></div><p>pour l&rsquo;instant on se contente juste de renvoyé les données reçu en body. Mais tester cette requête va s&rsquo;avérer plus compliqué car cette fois ci on doit envoyé des données.On peut le faire de deux différentes manière avec CURL, ou un client comme <a href=https://www.postman.com/downloads/>POSTMAN</a>, ce que je vous recommande et aussi ce que j&rsquo;utilise.
Donc dans le corps de notre requête sur POSTMAN on va y mettre un objet car.
<img src=images/postman-test.png alt=POSTREQ>.
Avec ceci notre CREATE est fait il nous reste donc le UPDATE et le DELETE.</p><h3 id=update>UPDATE</h3><p>Le UPDATE (PATCH en HTTP) en http est un mélange du GET du POST car on va devoir u&rsquo;a&bord chercher la ressource avec son id et ensuite lui dire les champs à éditer, dans l&rsquo;exemple on va juste le faire avec le proprio de la voiture, on va d&rsquo;abord créer la route qui convient</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>patch</span>(<span style=color:#e6db74>&#39;/api/car/:id&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt;{
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>id</span>
    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>car</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cars</span>.<span style=color:#a6e22e>find</span>(<span style=color:#a6e22e>element</span> =&gt; <span style=color:#a6e22e>element</span>.<span style=color:#a6e22e>id</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>id</span>);
    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>proprio</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>proprio</span>;
    <span style=color:#a6e22e>car</span>.<span style=color:#a6e22e>proprio</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>proprio</span>;
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>car</span>);
});
</code></pre></div><p>avec cette méthode</p></div><div class=btn-improve-page><a href=https://github.com/Salayna/Salayna.github.io/edit//content/posts/REST-API/index.fr.md><i class="fas fa-code-branch"></i>Améliorez cette page</a></div><hr><div class="row next-prev-navigator"><div class="col-md-12 next-article"><a href=/fr/posts/introduction/ class="btn btn-outline-info"><span>Suivant <i class="fas fa-chevron-circle-right"></i></span><br><span>Introduction</span></a></div></div><hr></div></div></div></section><section class=toc-section id=toc-section></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=#about>About</a></li><li class=nav-item><a class=smooth-scroll href=#skills>Compétences</a></li><li class=nav-item><a class=smooth-scroll href=#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=#recent-posts>Postes récents</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contactez moi :</h5><ul><li><span>Email:</span> <span>salaynadoukoure@gmail.com</span></li><li><span>Phone:</span> <span>+33652340788</span></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=#><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_2.png>
Toha</a></div><div class="col-md-4 text-center">© 2020 Copyright Salayna Doukoure.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/>Alimenté par
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/js/jquery-3.4.1.min.js></script><script src=/js/popper.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/navbar.js></script><script src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>