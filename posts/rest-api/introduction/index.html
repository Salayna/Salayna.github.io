<!doctype html><html><head><title>Getting started in REST APIs with NodeJS</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/navigators/navbar.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/favicon_hu8376fd15465fef26ffe66b6bcf0ca686_13669_42x0_resize_box_2.png><link rel=stylesheet href=/css/style.css><meta name=description content="Getting started in REST APIs with a NodeJS Tutorial"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-161583676-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/main-logo_hu864bbe108f1be1ae04b57f7f2fd9d631_5637_42x0_resize_box_2.png>Salayna's Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=languageSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img class=flag src=https://www.countryflags.io/gb/flat/16.png>
English</a><div class=dropdown-menu aria-labelledby=languageSelector><a class="dropdown-item nav-link languages-item" href=/fr/posts/rest-api/introduction><img class=flag src=https://www.countryflags.io/fr/flat/24.png>
Français</a></div></li></ul></div></div><img src=/images/main-logo_hu864bbe108f1be1ae04b57f7f2fd9d631_5637_42x0_resize_box_2.png class=d-none id=main-logo>
<img src=/images/inverted-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_42x0_resize_box_2.png class=d-none id=inverted-logo></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><input type=text placeholder=Search data-search id=search-box><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/rest-api/>API REST</a><ul class=active><li><a class=active href=/posts/rest-api/introduction/>Getting Started in REST APIs with NodeJS</a></li><li><a href=/posts/rest-api/mongodb/>NodeJS MongoDB API</a></li></ul></li><li><a href=/posts/introduction/>Introduction</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://salayna.github.io/posts/rest-api/introduction/hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/Salayna.png><h5 class=author-name>Salayna Doukoure</h5><p>March 3, 2021</p></div><div class=title><h1>Getting started in REST APIs with NodeJS</h1></div><div class=post-content id=post-content><p>REST APIs are a big parts of todays developpement landscapes, they&rsquo;re everywhere but are they and how do they work ? In this article we&rsquo;ll go through the basics of REST APIs using NodeJS.<br>You&rsquo;ll find all the source code of this project in this Github repository: <a href=https://Github.com/Salayna/api-rest-example>REST API example</a></p><h1 id=jump-links>Jump Links</h1><ul><li><a href=#what-is-an-api>What is an API</a><ul><li><a href=#the-rest-model>The REST Model</a><ul><li><a href=#quick-overview-of-the-http-protocol>Quick Overview of the HTTP Protocol</a></li></ul></li></ul></li><li><a href=#lets-code>Let&rsquo;s code</a><ul><li><a href=#project-setup>Project Setup</a></li><li><a href=#creating-the-web-server-and-sending-basic-text>Creating the web server and sending basic text</a></li><li><a href=#crud-on-api>CRUD on API</a><ul><li><a href=#read>Read</a></li><li><a href=#create>Create</a></li><li><a href=#update>Update</a></li><li><a href=#delete>Delete</a></li><li><a href=#status-codes>Status Codes</a></li></ul></li></ul></li></ul><h1 id=what-is-an-api>What is an API</h1><p>An Application Programming Interface (API) is a set of methods, variables, and protocols to connect two applications. There are several types of APIs:</p><ul><li>on the one hand we can have an API that can be used to use the functions of another application, for example to integrate certain modules with other applications</li><li>on the other hand we can have an API that will serve data to our application like APIs in GraphQL or Rest (what we will see today)</li></ul><h2 id=the-rest-model>The REST model</h2><p>The <strong>REST</strong>(REpresentational State Transfer) model is a set of rules and constraints to be followed when creating web services. These services allow manipulation of web resources and rely heavily on HTTP protocols.</p><h3 id=quick-overview-of-the-http-protocol>Quick overview of the HTTP Protocol</h3><p>The HTTP protocol is one of the main protocols of the World Wide Web (the famous www). The modern HTTP relies itself on the MIME (Multipurpose Internet Mail Extensions) which defines the files transferable through the internet (as its name indicates the MIME was first thought to send different types of files by mail)</p><h4 id=http-methods>HTTP methods</h4><p>The protocol includes methods that will define possible actions on resources, among which we can count:</p><ul><li>GET is the method for requesting a resource from the server</li><li>POST allows data to be sent to the server for resource creation</li><li>PUT also allows data to be sent to the server for a total addition or modification of the resource</li><li>DELETE removes the target resource</li><li>PATCH allows a partial modification of the resource</li></ul><p>REST APIs will rely on http methods to manage their requests.</p><h1 id=lets-code>Let&rsquo;s code</h1><p><em>ps: We will use NodeJS for this tutorial, in order to understand how it works</em></p><h2 id=project-setup>Project setup</h2><p>To begin we will initialize our project as follows:</p><ul><li>we will first create our folder (the name doesn’t matter)</li><li>make sure that Node is installed with the <code>node -v</code>' command if this is not the case I refer you to the official website <a href=https://nodejs.org/en/download/>https://nodejs.org/en/download/</a></li><li>Once Node is installed, we will perform the command <code>npm init</code>, we should have a prompt where we fill in trivial information and then we will have a file `package.json' at the root of our project.</li><li>we will then create an index.js file also the root of the project.</li></ul><p>Before going any further we will first explain some points seen above:</p><h3 id=what-is-nodejs->What is NodeJS ?</h3><p>NodeJS is a software platform that boosts Javascript, which was primarily a language used to make nice animations and make websites a little more dynamic. The NodeJS allows Javascript to be used on the server side and to do a lot of pretty amazing things (asynchronous programming etc&mldr;)</p><h3 id=what-is-the-packagejson->What is the package.json ?</h3><p>The package.json file serves as a control file for your project. The name, author, useful scripts, dependencies and lots of other information are stored inside this file.</p><h3 id=lets-add-our-dependencies>Let&rsquo;s add our dependencies</h3><p>We’re gonna need some dependencies on this project.</p><ul><li>Express: for web server creation and query management;</li><li>Nodemon: so you don’t always have to restart your app while you develop</li></ul><p>To install these dependencies we will use the command <code>npm install express</code>
You will note that I did not put nodemon in the command just, it is because I want to have nodemon that during development and not in production, so I will install it in <strong>dev dependency</strong> like this:
`npm install &ndash;save-dev nodemon'
Your package.json file should now have these two objects:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#e6db74>&#34;dependencies&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
   <span style=color:#f92672>&#34;express&#34;</span>: <span style=color:#e6db74>&#34;^4.17.1&#34;</span>
 }<span style=color:#960050;background-color:#1e0010>,</span>
 <span style=color:#e6db74>&#34;devDependencies&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
   <span style=color:#f92672>&#34;nodemon&#34;</span>: <span style=color:#e6db74>&#34;^2.0.7&#34;</span>
 }
</code></pre></div><p>and your folder now has a <code>package-lock.json</code> file that lists the dependencies of your dependencies, which are contained in the nodes_modules folder (I strongly advise against touching these two entities, but you can see if you are curious by nature).<br>Now that our project is in place, we can start coding.</p><h2 id=creating-the-web-server-and-sending-basic-text>Creating the web server and sending basic text</h2><p>In the index.js file we will add the following code:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>express</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;express&#34;</span>);
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>app</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>express</span>();

<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>sendStartingMessage</span>(<span style=color:#a6e22e>port</span>) {
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;app running on port &#39;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>port</span>)
}
<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>listen</span>(<span style=color:#ae81ff>3000</span>, <span style=color:#a6e22e>startingMessage</span>(<span style=color:#ae81ff>3000</span>));
</code></pre></div><p>Now by running the <code>node .</code> . command at the root of our project we should have the message &ldquo;app running on port 3000&rdquo; in the terminal. Okay, but how does that work? Let’s go line by line.<br>In the first two lines we will import our module with the function <code>require("{the name of the module to import}")</code>, which we will create an object in the variable <code>app</code>. We will then create a listening port with the <code>listen()</code> function which takes as parameter the listening port. You will note that <code>listen()</code> also has a rather special parameter which is the `sendStartingMessage()' function, this is called a callback and this callback will only be performed if the server is properly initialized. Let us make a very small change to it.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>express</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;express&#34;</span>);
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>app</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>express</span>();

<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>listen</span>(<span style=color:#ae81ff>3000</span>, ()=&gt;{
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;app running on port 3000&#39;</span>);
});
</code></pre></div><p>Your server is working now but you can’t do anything, so we’re going to create our first endpoint right above our `app.listen()':</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt; {
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#34;Welcome to this demo API&#34;</span>)
});
</code></pre></div><p>We have just added a GET with the <code>app.get()</code> function which takes as parameter the route of the resource in this case the root &lsquo;/&rsquo; and a callback whose arguments will be <strong>req</strong>: the request, <strong>res</strong>: the response we will then say, in this callback, to our server sent as a &ldquo;Welcome to this demo API&rdquo; response;
Before testing this request we will just add a small script that will simplify our life in the <code>package.json</code>. in the scripts object add:
```&ldquo;dev:start&rdquo;: &ldquo;nodemon .&rdquo; ``<br>Your scripts object should now look like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#e6db74>&#34;scripts&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
    <span style=color:#f92672>&#34;test&#34;</span>: <span style=color:#e6db74>&#34;echo \&#34;Error: no test specified\&#34; &amp;&amp; exit 1&#34;</span>,
    <span style=color:#f92672>&#34;dev:start&#34;</span>: <span style=color:#e6db74>&#34;nodemon .&#34;</span>
  }<span style=color:#960050;background-color:#1e0010>,</span>
</code></pre></div><p>you can then stop the execution of your code and type the command <code>npm run dev:start</code>in the terminal. now each time you save your changes the code will be executed automatically.
To test if our GET works, nothing is simpler, we will just go to our browser and go to the following address: http://localhost:3000/
You should have that result.<br><img src=images/api-message.png alt=response>.</p><p>Before going any further create dummy data for our API. So let’s create a cars array that will be a car array</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cars</span> <span style=color:#f92672>=</span> [];

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>car1</span> <span style=color:#f92672>=</span> {
    <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Tesla Model S&#34;</span>,
    <span style=color:#a6e22e>proprio</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Mr Ren&#34;</span>,
    <span style=color:#a6e22e>date</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2017</span>,
}

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>car2</span> <span style=color:#f92672>=</span> {
    <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>,
    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Lamborghini Urus&#34;</span>,
    <span style=color:#a6e22e>proprio</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Mr Pierre&#34;</span>,
    <span style=color:#a6e22e>date</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2019</span>,
}

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>car3</span> <span style=color:#f92672>=</span> {
    <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span>,
    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Ferrari Roma&#34;</span>,
    <span style=color:#a6e22e>proprio</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Mr Henry&#34;</span>,
    <span style=color:#a6e22e>date</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2016</span>,
}

<span style=color:#a6e22e>cars</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>car1</span>, <span style=color:#a6e22e>car2</span>, <span style=color:#a6e22e>car3</span>);
</code></pre></div><h2 id=crud-on-api>CRUD on API</h2><p>In the part below we will implement a CRUD (Create Read Update Delete) on cars.</p><h3 id=read>Read</h3><p>The Read goes through the GET method of the HTTP protocol.We will first start with the Read being the simplest function, we will make three read one that will recover all cars and two that will recover a car according to its attributes.
For the first Read we will add an endpoint on the road &lsquo;/cars&rsquo;. and this endpoint will just return the contents of our table cars.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;api/cars&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt; {
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>cars</span>);
})
</code></pre></div><p>Quite simple as a first function <em>note that I am ignoring everything that is database in an example of an API in production (probably the next lesson) the code will be much more provided</em>. For the next function we will recover a car based on some information about the car as parameter using the req parameter of the callback of the get function. But there are two ways to retrieve the parameter either through req.query' or through req.params' the choice of one of the two will change how to code the function. So we’re going to see both.</p><h4 id=reqparams>req.params</h4><p><strong>req.params</strong> will parse the parameters at the route level and not the URL. The difference between the route and the URL is quite subtle but let’s say that the URL is the entire entity for example the &ldquo;https://localhost:3000/cars&rdquo; where the route is more a path definition for example <code>api/cars/</code>. To use req.params we will first tell the router of our api that we expect a value at the level of the route like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/api/cars/:id&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt;{
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>id</span>  <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>id</span>
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>car</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cars</span>[<span style=color:#a6e22e>id</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>car</span>);
});
</code></pre></div><p>As you can see the route has a particular shape with its <code>:id</code>, this <code>:id</code> will let you tell the api that here you are expecting a variable and it is this variable that you will retrieve with the <code>req.params.id</code>.
the URL will have this head: <code>http://localhost:3000/api/cars/2</code></p><h5 id=reqquery>req.query</h5><p>For the <strong>req.query</strong> the request will completely change its head since the parameters will be parsed after a ``?```) (a query in English) and we do not need to specify to the router of the api before. the road will have this head:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/api/car&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt;{
 <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>query</span>.<span style=color:#a6e22e>id</span>;
 <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>date</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>query</span>.<span style=color:#a6e22e>date</span>;
 <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>car</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cars</span>.<span style=color:#a6e22e>find</span>(<span style=color:#a6e22e>element</span> =&gt; (<span style=color:#a6e22e>element</span>.<span style=color:#a6e22e>id</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>id</span>) <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#a6e22e>element</span>.<span style=color:#a6e22e>date</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>date</span>));
 <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>car</span>); 
});
</code></pre></div><p>Note that you can set as many parameters as you want, so you have to think ahead of time about what you want to recover knowing that if the parameters are not taken into account in the code it is as if they do not exist.
The URL for this route will look like this: `http://localhost:3000/api/car? id=2&date=2019'.</p><p>So we set up our <code>GET</code>s routes, but that does not stop there. We still have <code>POST</code>(for the CREATE), <code>PATCH</code>(for the UPDATE), <code>DELETE</code>(for the DELETE). Let’s go to POST.</p><h3 id=create>CREATE</h3><p>For this feature we go through the POST method of the HTTP protocol, but it will be a bit special this time. In the case of the POST method we will pass the data into the body of the request, the body, and to do so we will have to parse it, this is where the middleware `json™s integrates into the express that we will integrate like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>use</span>(<span style=color:#a6e22e>express</span>.<span style=color:#a6e22e>json</span>())
</code></pre></div><p>This middleware will therefore parse the data that the API will receive. Now we have to create the road that will take care of receiving this data so we will create a road post this time:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/api/cars&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt; {
 <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>body</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>body</span>;
 <span style=color:#a6e22e>cars</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>body</span>);
 <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>body</span>);
});
</code></pre></div><p>Testing this request will be more complicated because this time we have to send data. You can do this in two ways with CURL, or a customer like <a href=https://www.postman.com/downloads/>POSTMAN</a>, which I recommend and also what I use.
So in the body of our request on POSTMAN we’re going to put a car in it.
<img src=images/postman-test.png alt=POSTREQ>.
With this our CREATE is done, so we still have the UPDATE and DELETE.</p><h3 id=update>UPDATE</h3><p>The UPDATE (HTTP PATCH) in HTTP is a mixture of the GET and the POST because we will first have to look for the resource with its id and then tell it the fields to edit, in the example we will just do it with the owner of the car, we will first create the appropriate route</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>patch</span>(<span style=color:#e6db74>&#39;/api/car/:id&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt;{
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>id</span>
    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>proprio</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>proprio</span>;
    <span style=color:#a6e22e>cars</span>[<span style=color:#a6e22e>id</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>].<span style=color:#a6e22e>proprio</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>proprio</span>;
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>cars</span>[<span style=color:#a6e22e>id</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]);
});
</code></pre></div><p><img src=images/postman-patch.png alt=patch>
With this method we manage to modify a data now it only remains to be able to delete it.</p><h3 id=delete>DELETE</h3><p>The DELETE is the same as the PATCH except that here we do not want to edit a data but delete it, so we will do it like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#66d9ef>delete</span>(<span style=color:#e6db74>&#39;/api/car/:id&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt;{
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>id</span>;
    <span style=color:#a6e22e>cars</span>.<span style=color:#a6e22e>splice</span>(<span style=color:#a6e22e>id</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>);
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>cars</span>);
});
</code></pre></div><p><img src=images/postman-delete.png alt=delete>
And normally you should have your operational CRUD, but an API remains is more than that, because we also need to know if our operation is a success or a failure and that’s where the response code between games.</p><h3 id=status-codes>Status Codes</h3><p>Status Codes are classified as follows:</p><ul><li>2XX corresponds to successful requests</li><li>4xx corresponds to failures but customer side</li><li>5xx corresponds to side errors</li></ul><p>you will find a list of <a href=https://developer.mozilla.org/en/docs/Web/HTTP/Status>code</a> here.</p><p>So we’ll, uh, add in the success codes and then we’ll go deal with the mistakes. Success codes are quite simple to add just put it in the prefix of the send, in this way <code>res.status({status code}). send({our message})</code>.
For the create case it will be a 201 code so the response will look like that `res.status(201). send({message: &ldquo;Car added to the db&rdquo;, entity: car}) and for the rest we use 200 <em>note that to delete we can put 204 provided the request is empty</em>.</p><p>We can then move to error management in the case of get you must check that the resources can be found. So we will perform the checks and if this is not the case we will send error code 404(the famous) with the message &ldquo;resource not found&rdquo; then we must check if the data sent is good, if our property field is a text and not a number, if applicable, an error 400 will be placed followed by the message (Bad request).</p><p>We end up with the following code:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>express</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;express&#34;</span>);
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>app</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>express</span>();
<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>use</span>(<span style=color:#a6e22e>express</span>.<span style=color:#a6e22e>json</span>())

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cars</span> <span style=color:#f92672>=</span> [];

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>car1</span> <span style=color:#f92672>=</span> {
    <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Tesla Model S&#34;</span>,
    <span style=color:#a6e22e>proprio</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Mr Ren&#34;</span>,
    <span style=color:#a6e22e>date</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2017</span>,
}

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>car2</span> <span style=color:#f92672>=</span> {
    <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>,
    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Lamborghini Urus&#34;</span>,
    <span style=color:#a6e22e>proprio</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Mr Pierre&#34;</span>,
    <span style=color:#a6e22e>date</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2019</span>,
}

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>car3</span> <span style=color:#f92672>=</span> {
    <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span>,
    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Ferrari Roma&#34;</span>,
    <span style=color:#a6e22e>proprio</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Mr Henry&#34;</span>,
    <span style=color:#a6e22e>date</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2016</span>,
}

<span style=color:#a6e22e>cars</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>car1</span>, <span style=color:#a6e22e>car2</span>, <span style=color:#a6e22e>car3</span>);

<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt; {
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#34;Welcome to this demo API&#34;</span>)
});

<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/api/cars&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt; {
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>cars</span>);
});

<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/api/cars/:id&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt;{
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>id</span>  <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>id</span>
    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>cars</span>[<span style=color:#a6e22e>id</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]){
        <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>404</span>).<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#34;ressources not found&#34;</span>);
        <span style=color:#66d9ef>return</span>;
    }
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>200</span>).<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>car</span>);
});

<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/api/cars&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt; {
 <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>body</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>body</span>;
 <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>id</span> <span style=color:#f92672>||!</span><span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>||</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>proprio</span> <span style=color:#f92672>||</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>date</span>) {
     <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>400</span>).<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#34;Bad Request&#34;</span>);
     <span style=color:#66d9ef>return</span>
 }
 
 <span style=color:#a6e22e>cars</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>body</span>);
 <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>201</span>).<span style=color:#a6e22e>send</span>({
     <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Entity added to the db&#34;</span>,
     <span style=color:#a6e22e>entity</span><span style=color:#f92672>:</span><span style=color:#a6e22e>body</span>
 })
});

<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>patch</span>(<span style=color:#e6db74>&#39;/api/car/:id&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt;{
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>id</span>
    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>cars</span>[<span style=color:#a6e22e>id</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]){
        <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>404</span>).<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#34;ressources not found&#34;</span>);
    } 
    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>proprio</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>proprio</span>;
    <span style=color:#66d9ef>if</span>(<span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>proprio</span> <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;string&#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>proprio</span> <span style=color:#66d9ef>instanceof</span> String <span style=color:#f92672>===</span> <span style=color:#66d9ef>false</span>) {
        <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>400</span>).<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#34;Bad Request&#34;</span>);
        <span style=color:#66d9ef>return</span>;
    };
    <span style=color:#a6e22e>cars</span>[<span style=color:#a6e22e>id</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>].<span style=color:#a6e22e>proprio</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>proprio</span>;
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>200</span>).<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>cars</span>[<span style=color:#a6e22e>id</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]);
});

<span style=color:#a6e22e>app</span>.<span style=color:#66d9ef>delete</span>(<span style=color:#e6db74>&#39;/api/car/:id&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)=&gt;{
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>id</span>;
    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>cars</span>[<span style=color:#a6e22e>id</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]) {
        <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>404</span>).<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#34;Ressource not found&#34;</span>);
        <span style=color:#66d9ef>return</span>;
    }
    <span style=color:#a6e22e>cars</span>.<span style=color:#a6e22e>splice</span>(<span style=color:#a6e22e>id</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>);
    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>200</span>).<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>cars</span>);
});

<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>listen</span>(<span style=color:#ae81ff>3000</span>, ()=&gt;{
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;app running on port 3000&#39;</span>);
});
</code></pre></div><p>Voilà ! You have your first REST API !</p><p>The next classes of the serie will be on making a REST API with a NoSQL database(like MongoDB) and One with a SQL Database(like PostgreSQL) with and without and ORM(I&rsquo;ll explain everything in a next class).</p><p>Do not hesitate to give me feedbacks bin the comment section just below ! See you soon !</p></div><div class=btn-improve-page><a href=https://github.com/Salayna/Salayna.github.io/edit//content/posts/REST-API/Introduction/index.md><i class="fas fa-code-branch"></i>Improve this page</a></div><hr><div class="row next-prev-navigator"><div class="col-md-12 next-article"><a href=/posts/rest-api/mongodb/ class="btn btn-outline-info"><span>Next <i class="fas fa-chevron-circle-right"></i></span><br><span>NodeJS MongoDB API</span></a></div></div><hr><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;var disqus_shortname="salayna";dsq.src="//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><div class="dropdown languageSelector"><a class="btn dropdown-toggle" href=# id=languageSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img class=flag src=https://www.countryflags.io/gb/flat/16.png>
English</a><div class=dropdown-menu aria-labelledby=languageSelector><a class="dropdown-item nav-link languages-item" href=/fr/posts/rest-api/introduction><img class=flag src=https://www.countryflags.io/fr/flat/24.png>
Français</a></div></div></section><section class=toc-section id=toc-section></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=#about>About</a></li><li class=nav-item><a class=smooth-scroll href=#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=#recent-posts>Recent Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>salaynadoukoure@gmail.com</span></li><li><span>Phone:</span> <span>+33652340788</span></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=#><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_2.png>
Toha</a></div><div class="col-md-4 text-center">© 2020 Copyright Salayna Doukoure.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/js/jquery-3.4.1.min.js></script><script src=/js/popper.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/navbar.js></script><script src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>